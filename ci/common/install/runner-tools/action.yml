##
# (c) 2024 - Cloud Ops Works LLC - https://cloudops.works/
#            On GitHub: https://github.com/cloudopsworks
#            Distributed Under Apache v2.0 License
#
name: Install Runner tools
author: cloudopsworks
description: Install runner-tools for the workflow

runs:
  using: 'composite'
  steps:
    - name: Install runner-tools
      working-directory: /tmp
      shell: bash
      run: |
        echo "::group::Install runner-tools"
        (type -p wget >/dev/null || (sudo apt update && sudo apt-get install wget -y))
        sudo wget https://github.com/mikefarah/yq/releases/latest/download/yq_linux_amd64 -O /usr/bin/yq && sudo chmod +x /usr/bin/yq
        sudo apt install -y gh jq curl zip unzip python3 python3-pip
        curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
        unzip -qo awscliv2.zip
        which aws || sudo ./aws/install
        which aws && sudo ./aws/install --update
        curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash
        az extension add --name azure-devops
        echo "::endgroup::"
